(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{99403:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leads/active",function(){return n(91145)}])},15271:function(e,t,n){"use strict";n.d(t,{A4:function(){return l},Dm:function(){return a},Yd:function(){return u},_n:function(){return o}});let i=["January","February","March","April","May","June","July","August","September","October","November","December"],l=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},a=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},s=e=>new Date(e),r=e=>"0"!==e.charAt(0)&&1===e.length?"0"+e:e,o=e=>{let t=s(e),n=r(t.getDate().toString()),i=r((t.getMonth()+1).toString()),l=t.getFullYear().toString();return"".concat(l,"-").concat(i,"-").concat(n)},u=e=>{if(""==e)return"";let t=s(e),n=t.getFullYear()+"-"+r((t.getMonth()+1).toString())+"-"+r(t.getDate().toString())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return n}},91145:function(e,t,n){"use strict";n.r(t);var i=n(85893),l=n(80562),a=n(73812),s=n(31538),r=n(29630),o=n(79072),u=n(49837),d=n(62443),p=n(67294),c=n(10667),m=n(9473),x=n(99610),b=n(18424),v=n(23213),h=n(46160),f=n(3690),g=n(68045),C=n(15271),y=n(89829),_=n(96927),j=n(59232),I=n(93023),Z=n(86501);let T=e=>{let{id:t,course_id:n,quoted_price:r}=e,[o,u]=(0,p.useState)(null),d=(0,m.I0)(),c=(0,b.a)(),v=c.token,[T,S]=(0,p.useState)(!1),[L,P]=(0,p.useState)(!1),[w,k]=(0,p.useState)(!1),[O,N]=(0,p.useState)(!1),[D,A]=(0,p.useState)([]),[E,U]=(0,p.useState)(!1),[F,B]=(0,p.useState)(""),[z,M]=(0,p.useState)(""),[W,q]=(0,p.useState)(),[H,Q]=(0,p.useState)([]),[Y,G]=(0,p.useState)(!1),[J,R]=(0,p.useState)(!1),X=Boolean(o),K=()=>{R(!J)},V=e=>{let n=Object.values(e.input[0])[0];d((0,x.XH)({token:v,lead_id:t,type:n}))};(0,p.useEffect)(()=>{(async function(){let e=await (0,_.Z)(v).get("/leads/followup/details/".concat(t));q(e.data.lead)})()},[t,v,J]),(0,p.useEffect)(()=>{if(W){let e=W.followups.map(e=>({text:e.remarks,date:(0,C.A4)(e.date_of_next_action)}));Q(e)}},[W]),(0,p.useEffect)(()=>{(async function(){let e=await (0,_.Z)(v).post("/batch/list/available",{course_id:n});A(e.data.batches.map(e=>({label:"".concat(e.location," - ").concat(e.course_name," - ").concat(e.start_date),value:e.id.toString()})))})()},[n,v]);let $=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=(0,C._n)(i);d((0,x._m)({token:v,lead_id:t,remarks:n,follow_up_date:l})),K()},ee=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];if(0==r||null==r){Z.ZP.error("Please assign quoted price first");return}"Converted"===n?(U(!0),B(n),M(i)):d((0,x.U6)({token:v,lead_id:t,status:n,closing_remark:i}))},et=e=>{u(e.currentTarget)},en=()=>{u(null)},ei=()=>{en(),G(!0)},el=e=>{let n=Object.values(e.input[0])[0];d((0,x.Dc)({token:v,lead_id:t,quoted_price:parseInt(n)}))},ea=()=>{d((0,x.ks)({token:v,lead_id:t}))},es=()=>{en(),S(!0)},er=()=>{en(),P(!0)},eo=()=>{en(),k(!0)},eu=()=>{en(),N(!0)},ed=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=Object.values(e.input[2])[0],a=n.length;if(1==a){let s=n[0];d((0,j.O2)({token:v,batchGroup:{batch_id:parseInt(s),participant_id:t,payment_method:l,paid_amt:parseInt(i)}}))}else d((0,j.Zy)({token:v,batchGroupMultiple:{batch_id:n,participant_id:t,payment_method:l,paid_amt:parseInt(i)}}));d((0,x.U6)({token:v,lead_id:t,status:F,closing_remark:z}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{size:"small",onClick:et,children:(0,i.jsx)(h.Z,{})}),(0,i.jsxs)(a.Z,{keepMounted:!0,anchorEl:o,open:X,onClose:en,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(s.Z,{onClick:eu,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Unassign Self"]}),(0,i.jsxs)(s.Z,{onClick:es,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Change Lead Probability"]}),(0,i.jsxs)(s.Z,{onClick:er,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Follow Up"]}),(0,i.jsxs)(s.Z,{onClick:ei,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Assign Quoted Price"]}),(0,i.jsxs)(s.Z,{onClick:eo,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Close Lead"]})]}),(0,i.jsx)(g.Z,{dialogTitle:"Update Lead Probability",isOpen:T,setIsOpen:S,onSubmit:V,submitButtonText:"Update",inputs:[{inputId:"type",inputLabel:"Probability",inputType:"select",inputLabelId:"type-label",gridProps:{md:6},menuItems:[{value:"high",label:"HIGH"},{value:"medium",label:"MEDIUM"},{value:"low",label:"LOW"}]}]}),(0,i.jsx)(g.Z,{dialogTitle:"Assign Quoted Price",isOpen:Y,setIsOpen:G,submitButtonText:"Assign",onSubmit:el,inputs:[{inputId:"quoted_price",inputLabel:"Quoted Price",inputType:"number",inputLabelId:"quoted_price-label",gridProps:{md:6}}]}),(0,i.jsx)(g.Z,{dialogTitle:"Close Lead",isOpen:w,setIsOpen:k,onSubmit:ee,submitButtonText:"Close Lead",maxWidth:"lg",inputs:[{inputId:"status",inputLabel:"Status",inputType:"select",inputLabelId:"status-select",gridProps:{md:3},menuItems:[{value:"Converted",label:"Converted"},{value:"Failed",label:"Failed"}]},{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}}]}),(0,i.jsx)(y.Z,{agreeText:"Unassign",dialogText:"Confirm Unassign Self From The Lead",dialogTitle:"Confirm Unassign Self",disagreeText:"Cancel",isOpen:O,setOnAgree:ea,setOpen:N}),(0,i.jsx)(g.Z,{isOpen:E,setIsOpen:U,dialogTitle:"Assign Participant",submitButtonText:"Assign",onSubmit:ed,maxWidth:"lg",inputs:[{inputId:"batches",inputType:"select",selectMultiple:!0,inputLabel:"Batches",inputLabelId:"batches-label",menuItems:D,gridProps:{mb:6,md:4}},{inputId:"payment_amount",inputType:"number",inputLabel:"Payment Amount",inputLabelId:"payment_amount-label",gridProps:{mb:6,md:4}},{inputId:"payment_type",inputType:"select",inputLabel:"Payment Type",inputLabelId:"payment_type-label",menuItems:[{value:"Cash",label:"Cash"},{value:"Online",label:"Online"},{value:"Credit Card",label:"Credit Card"},{value:"Bank Deposit",label:"Bank Deposit"},{value:"Bank Transfer",label:"Bank Transfer"}],gridProps:{mb:6,md:4}}]}),(0,i.jsx)(I.Z,{dialogTitle:"Lead Followup History",isOpen:L,setIsOpen:P,onSubmit:$,maxWidth:"md",timelineData:H,submitButtonText:"Add Followup",inputs:[{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}},{inputId:"followup_date",inputLabel:"Follow Up Date",inputType:"date",inputLabelId:"followup_date-label",gridProps:{md:3}}]})]})},S=[{flex:.1,field:"name",headerName:"Name",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.name),Z.ZP.success("Text Copied Successfully")},children:t.name})}},{flex:.1,field:"contact_no",headerName:"Contact No",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.contact_no),Z.ZP.success("Text Copied Successfully")},children:t.contact_no})}},{flex:.1,field:"email",headerName:"Email",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.email),Z.ZP.success("Text Copied Successfully")},children:t.email})}},{flex:.1,field:"company",headerName:"Company",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.company),Z.ZP.success("Text Copied Successfully")},children:t.company})}},{flex:.1,field:"course_name",headerName:"Course",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.course_name),Z.ZP.success("Text Copied Successfully")},children:t.course_name})}},{flex:.1,field:"quoted_price",headerName:"Quoted Price",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{variant:"body2",children:t.quoted_price})}},{flex:.1,field:"next_update",headerName:"Next Update",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{variant:"body2",children:"Nothing Found"!==t.next_update?(0,C.Dm)(t.next_update):t.next_update})}},{flex:.1,field:"createdAt",headerName:"Created At",renderCell(e){let{row:t}=e;return(0,i.jsx)(v.Z,{skin:"light",size:"small",label:(0,C.Yd)(t.created_at),sx:{textTransform:"capitalize"}})}},{flex:.1,minWidth:90,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:t}=e;return(0,i.jsx)(T,{id:t.id,course_id:t.course_id,quoted_price:t.quoted_price})}}];t.default=function(){let[e,t]=(0,p.useState)([]),[n,l]=(0,p.useState)(10),[a,s]=(0,p.useState)(""),r=(0,m.I0)(),v=(0,m.v9)(e=>e.leads),h=(0,b.a)(),f=h.token,g=e=>{s(e)};return(0,p.useEffect)(()=>{r((0,x.Ud)({token:f}))},[r,f]),(0,p.useEffect)(()=>{let e=v.activeLeads.filter(e=>{var t,n,i,l,s,r,o,u,d,p,c,m;return(null===(n=null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes(a.toLowerCase()))||(null===(l=null===(i=e.contact_no)||void 0===i?void 0:i.toLowerCase())||void 0===l?void 0:l.includes(a.toLowerCase()))||(null===(r=null===(s=e.email)||void 0===s?void 0:s.toLowerCase())||void 0===r?void 0:r.includes(a.toLowerCase()))||(null===(u=null===(o=e.company)||void 0===o?void 0:o.toLowerCase())||void 0===u?void 0:u.includes(a.toLowerCase()))||(null===(p=null===(d=e.course_name)||void 0===d?void 0:d.toLowerCase())||void 0===p?void 0:p.includes(a.toLowerCase()))||(null===(m=null===(c=e.type)||void 0===c?void 0:c.toLowerCase())||void 0===m?void 0:m.includes(a.toLowerCase()))});t(e)},[a,v.activeLeads]),(0,i.jsxs)(o.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(o.ZP,{item:!0,xs:12}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(c.Z,{exportFileName:"Active Leads",exportData:(()=>{let t=e.map(e=>({Name:e.name,"Contact No":e.contact_no,Email:e.email,Company:e.company,Course:e.course_name,"Quoted Price":e.quoted_price,Type:e.type.toUpperCase(),"Next Update":e.next_update}));return t})(),handleFilter:g,searchBoxText:"Search Leads",value:a}),(0,i.jsx)(d._,{autoHeight:!0,pagination:!0,rows:e,columns:S,disableSelectionOnClick:!0,pageSize:Number(n),rowsPerPageOptions:[10,25,50],onPageSizeChange:e=>l(e)})]})})]})}},93023:function(e,t,n){"use strict";var i=n(85893),l=n(29620),a=n(77745),s=n(95398),r=n(79072),o=n(76779),u=n(75084),d=n(61953),p=n(67074),c=n(17494),m=n(87413),x=n(29630),b=n(72162),v=n(9601),h=n(51221),f=n(36599),g=n(39673),C=n(48621),y=n(40883),_=n(87536);let j=(0,p.ZP)(f.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}});t.Z=function(e){var t,n,p,f;let I=(()=>{let t={input:[]};return e.inputs&&e.inputs.forEach(e=>{let n={};n[e.inputId]="",t.input.push(n)}),t})(),{control:Z,handleSubmit:T,reset:S,formState:{errors:L}}=(0,_.cI)({defaultValues:I}),P=()=>{e.setIsOpen(!1),S()},w=t=>{e.setIsOpen(!1),S(),e.onSubmit&&e.onSubmit(t)},k=t=>{var n;return e.inputs&&(null===(n=e.inputs.find(e=>e.inputId===t))||void 0===n?void 0:n.menuItems)};return(0,i.jsx)("div",{children:(0,i.jsxs)(l.Z,{maxWidth:e.maxWidth,fullWidth:!0,open:e.isOpen,onClose:P,children:[(0,i.jsx)(a.Z,{children:e.dialogTitle}),(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(r.ZP,{container:!0,spacing:5,children:(0,i.jsx)(r.ZP,{item:!0,xs:12,children:(0,i.jsx)(j,{children:e.timelineData.map((e,t)=>(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(c.Z,{color:"success",variant:"outlined"}),(0,i.jsx)(h.Z,{})]}),(0,i.jsx)(b.Z,{children:(0,i.jsxs)(d.Z,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(x.Z,{variant:"body2",sx:{justifyContent:"flex-start",mr:2,fontWeight:600,color:"text.primary"},children:e.text}),(0,i.jsx)(x.Z,{sx:{justifyContent:"flex-end",flex:"0 0 11em"},variant:"caption",children:e.date})]})})]},t))})})}),(0,i.jsxs)(r.ZP,{container:!0,spacing:5,children:[e.inputs&&e.inputs.map((e,l)=>{var a,s;return"select"===e.inputType?(0,i.jsx)(g.Z,{name:"input.".concat(l,".").concat(e.inputId),label:e.inputLabel,labelId:e.inputLabelId,inputId:e.inputId,menuItems:null!==(t=k(e.inputId))&&void 0!==t?t:[],control:Z,description:"".concat(e.inputId,"-description"),error:null==L?void 0:null===(a=L.input)||void 0===a?void 0:null===(s=a[l])||void 0===s?void 0:s[e.inputId],gridProps:null!==(n=e.gridProps)&&void 0!==n?n:{}},l):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"text"===e.inputType||"textarea"==e.inputType||"number"==e.inputType||"email"==e.inputType?(0,i.jsx)(C.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:Z,description:"".concat(e.inputId,"-description"),error:null==L?void 0:null===(n=L.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],type:e.inputType,gridProps:null!==(p=e.gridProps)&&void 0!==p?p:{},rows:"textarea"===e.inputType?6:1,multiline:"textarea"===e.inputType},t):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"date"===e.inputType||"datetime"===e.inputType?(0,i.jsx)(y.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:Z,description:"".concat(e.inputId,"-description"),error:null==L?void 0:null===(n=L.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],gridProps:null!==(f=e.gridProps)&&void 0!==f?f:{},time:"datetime"===e.inputType},t):null})]})]}),e.inputs?(0,i.jsxs)(o.Z,{children:[(0,i.jsx)(u.Z,{onClick:P,variant:"outlined",children:"Cancel"}),(0,i.jsx)(u.Z,{onClick:T(w),variant:"outlined",children:null==e?void 0:e.submitButtonText})]}):null]})})}}},function(e){e.O(0,[891,842,536,215,292,763,981,774,888,179],function(){return e(e.s=99403)}),_N_E=e.O()}]);