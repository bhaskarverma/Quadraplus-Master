(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{97475:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leads/followup-today",function(){return n(7072)}])},15271:function(e,t,n){"use strict";n.d(t,{A4:function(){return l},Dm:function(){return a},Yd:function(){return u},_n:function(){return s}});let i=["January","February","March","April","May","June","July","August","September","October","November","December"],l=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},a=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},o=e=>new Date(e),r=e=>"0"!==e.charAt(0)&&1===e.length?"0"+e:e,s=e=>{let t=o(e),n=r(t.getDate().toString()),i=r((t.getMonth()+1).toString()),l=t.getFullYear().toString();return"".concat(l,"-").concat(i,"-").concat(n)},u=e=>{if(""==e)return"";let t=o(e),n=t.getFullYear()+"-"+r((t.getMonth()+1).toString())+"-"+r(t.getDate().toString())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return n}},7072:function(e,t,n){"use strict";n.r(t);var i=n(85893),l=n(80562),a=n(73812),o=n(31538),r=n(29630),s=n(79072),u=n(49837),d=n(62443),c=n(67294),p=n(10667),m=n(9473),x=n(99610),f=n(18424),v=n(23213),b=n(46160),h=n(3690),g=n(68045),C=n(15271),j=n(89829),y=n(86501),Z=n(93023),T=n(96927);let w={GREEN:"success",ORANGE:"warning",RED:"error"},I=e=>{let{id:t}=e,[n,r]=(0,c.useState)(null),s=(0,m.I0)(),u=(0,f.a)(),d=u.token,[p,v]=(0,c.useState)(!1),[y,w]=(0,c.useState)(!1),[I,S]=(0,c.useState)(!1),[_,L]=(0,c.useState)(!1),[P,k]=(0,c.useState)([]),[O,N]=(0,c.useState)(),[E,D]=(0,c.useState)(!1),F=Boolean(n),U=e=>{let n=Object.values(e.input[0])[0];s((0,x.XH)({token:d,lead_id:t,type:n}))};(0,c.useEffect)(()=>{if(O){let e=O.followups.map(e=>({text:e.remarks,date:(0,C.A4)(e.date_of_next_action)}));k(e)}},[O]),(0,c.useEffect)(()=>{(async function(){let e=await (0,T.Z)(d).get("/leads/followup/details/".concat(t));N(e.data.lead)})()},[t,d,E]);let z=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=(0,C._n)(i);s((0,x._m)({token:d,lead_id:t,remarks:n,follow_up_date:l}))},A=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];s((0,x.U6)({token:d,lead_id:t,status:n,closing_remark:i}))},M=e=>{r(e.currentTarget)},W=()=>{r(null)},B=()=>{s((0,x.ks)({token:d,lead_id:t}))},H=()=>{W(),v(!0)},R=()=>{W(),w(!0)},G=()=>{W(),S(!0)},J=()=>{W(),L(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{size:"small",onClick:M,children:(0,i.jsx)(b.Z,{})}),(0,i.jsxs)(a.Z,{keepMounted:!0,anchorEl:n,open:F,onClose:W,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(o.Z,{onClick:J,children:[(0,i.jsx)(h.Z,{fontSize:"small",sx:{mr:2}}),"Unassign Self"]}),(0,i.jsxs)(o.Z,{onClick:H,children:[(0,i.jsx)(h.Z,{fontSize:"small",sx:{mr:2}}),"Change Lead Probability"]}),(0,i.jsxs)(o.Z,{onClick:R,children:[(0,i.jsx)(h.Z,{fontSize:"small",sx:{mr:2}}),"Follow Up"]}),(0,i.jsxs)(o.Z,{onClick:G,children:[(0,i.jsx)(h.Z,{fontSize:"small",sx:{mr:2}}),"Close"]})]}),(0,i.jsx)(g.Z,{dialogTitle:"Update Lead Probability",isOpen:p,setIsOpen:v,onSubmit:U,submitButtonText:"Update",inputs:[{inputId:"type",inputLabel:"Probability",inputType:"select",inputLabelId:"type-label",gridProps:{md:6},menuItems:[{value:"high",label:"HIGH"},{value:"medium",label:"MEDIUM"},{value:"low",label:"LOW"}]}]}),(0,i.jsx)(Z.Z,{dialogTitle:"Lead Followup History",isOpen:y,setIsOpen:w,onSubmit:z,maxWidth:"md",timelineData:P,submitButtonText:"Add Followup",inputs:[{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}},{inputId:"followup_date",inputLabel:"Follow Up Date",inputType:"date",inputLabelId:"followup_date-label",gridProps:{md:3}}]}),(0,i.jsx)(g.Z,{dialogTitle:"Close Lead",isOpen:I,setIsOpen:S,onSubmit:A,submitButtonText:"Close Lead",inputs:[{inputId:"status",inputLabel:"Status",inputType:"select",inputLabelId:"status-select",gridProps:{md:6},menuItems:[{value:"Converted",label:"Converted"},{value:"Failed",label:"Failed"}]},{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:6}}]}),(0,i.jsx)(j.Z,{agreeText:"Unassign",dialogText:"Confirm Unassign Self From The Lead",dialogTitle:"Confirm Unassign Self",disagreeText:"Cancel",isOpen:_,setOnAgree:B,setOpen:L})]})},S=[{flex:.1,field:"name",headerName:"Name",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.name),y.ZP.success("Text Copied Successfully")},children:t.name})}},{flex:.1,field:"contact_no",headerName:"Contact No",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.contact_no),y.ZP.success("Text Copied Successfully")},children:t.contact_no})}},{flex:.1,field:"email",headerName:"Email",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.email),y.ZP.success("Text Copied Successfully")},children:t.email})}},{flex:.1,field:"company",headerName:"Company",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.company),y.ZP.success("Text Copied Successfully")},children:t.company})}},{flex:.1,field:"course_name",headerName:"Course",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.course_name),y.ZP.success("Text Copied Successfully")},children:t.course_name})}},{flex:.1,field:"next_update",headerName:"Next Update",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{variant:"body2",children:(0,C.Dm)(t.next_update)})}},{flex:.1,field:"type",headerName:"Probability",renderCell(e){let{row:t}=e;return(0,i.jsx)(v.Z,{skin:"light",size:"small",label:t.type.toUpperCase(),color:w[t.type.toUpperCase()],sx:{textTransform:"capitalize"}})}},{flex:.1,minWidth:90,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:t}=e;return(0,i.jsx)(I,{id:t.id})}}];t.default=function(){let[e,t]=(0,c.useState)([]),[n,l]=(0,c.useState)(10),[a,o]=(0,c.useState)(""),r=(0,m.I0)(),v=(0,m.v9)(e=>e.leads),b=(0,f.a)(),h=b.token,g=e=>{o(e)};return(0,c.useEffect)(()=>{r((0,x.dN)({token:h}))},[r,h]),(0,c.useEffect)(()=>{if(v.followupLeads){let e=v.followupLeads.filter(e=>{var t,n,i,l,o;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(n=e.contact_no)||void 0===n?void 0:n.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(i=e.email)||void 0===i?void 0:i.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(l=e.company)||void 0===l?void 0:l.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(o=e.course_name)||void 0===o?void 0:o.toLowerCase().includes(a.toLowerCase()))});t(e)}},[a,v.followupLeads]),(0,i.jsxs)(s.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(s.ZP,{item:!0,xs:12}),(0,i.jsx)(s.ZP,{item:!0,xs:12,children:(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(p.Z,{exportFileName:"Followup Leads for Today",exportData:(()=>{let t=e.map(e=>({Name:e.name,"Contact No":e.contact_no,Email:e.email,Company:e.company,Course:e.course_name,Type:e.type.toUpperCase()}));return t})(),handleFilter:g,searchBoxText:"Search Leads",value:a}),(0,i.jsx)(d._,{autoHeight:!0,pagination:!0,rows:e,columns:S,disableSelectionOnClick:!0,pageSize:Number(n),rowsPerPageOptions:[10,25,50],onPageSizeChange:e=>l(e)})]})})]})}},93023:function(e,t,n){"use strict";var i=n(85893),l=n(29620),a=n(77745),o=n(95398),r=n(79072),s=n(76779),u=n(75084),d=n(61953),c=n(67074),p=n(17494),m=n(87413),x=n(29630),f=n(72162),v=n(9601),b=n(51221),h=n(36599),g=n(39673),C=n(48621),j=n(40883),y=n(87536);let Z=(0,c.ZP)(h.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}});t.Z=function(e){var t,n,c,h;let T=(()=>{let t={input:[]};return e.inputs&&e.inputs.forEach(e=>{let n={};n[e.inputId]="",t.input.push(n)}),t})(),{control:w,handleSubmit:I,reset:S,formState:{errors:_}}=(0,y.cI)({defaultValues:T}),L=()=>{e.setIsOpen(!1),S()},P=t=>{e.setIsOpen(!1),S(),e.onSubmit&&e.onSubmit(t)},k=t=>{var n;return e.inputs&&(null===(n=e.inputs.find(e=>e.inputId===t))||void 0===n?void 0:n.menuItems)};return(0,i.jsx)("div",{children:(0,i.jsxs)(l.Z,{maxWidth:e.maxWidth,fullWidth:!0,open:e.isOpen,onClose:L,children:[(0,i.jsx)(a.Z,{children:e.dialogTitle}),(0,i.jsxs)(o.Z,{children:[(0,i.jsx)(r.ZP,{container:!0,spacing:5,children:(0,i.jsx)(r.ZP,{item:!0,xs:12,children:(0,i.jsx)(Z,{children:e.timelineData.map((e,t)=>(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(p.Z,{color:"success",variant:"outlined"}),(0,i.jsx)(b.Z,{})]}),(0,i.jsx)(f.Z,{children:(0,i.jsxs)(d.Z,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(x.Z,{variant:"body2",sx:{justifyContent:"flex-start",mr:2,fontWeight:600,color:"text.primary"},children:e.text}),(0,i.jsx)(x.Z,{sx:{justifyContent:"flex-end",flex:"0 0 11em"},variant:"caption",children:e.date})]})})]},t))})})}),(0,i.jsxs)(r.ZP,{container:!0,spacing:5,children:[e.inputs&&e.inputs.map((e,l)=>{var a,o;return"select"===e.inputType?(0,i.jsx)(g.Z,{name:"input.".concat(l,".").concat(e.inputId),label:e.inputLabel,labelId:e.inputLabelId,inputId:e.inputId,menuItems:null!==(t=k(e.inputId))&&void 0!==t?t:[],control:w,description:"".concat(e.inputId,"-description"),error:null==_?void 0:null===(a=_.input)||void 0===a?void 0:null===(o=a[l])||void 0===o?void 0:o[e.inputId],gridProps:null!==(n=e.gridProps)&&void 0!==n?n:{}},l):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"text"===e.inputType||"textarea"==e.inputType||"number"==e.inputType||"email"==e.inputType?(0,i.jsx)(C.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:w,description:"".concat(e.inputId,"-description"),error:null==_?void 0:null===(n=_.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],type:e.inputType,gridProps:null!==(c=e.gridProps)&&void 0!==c?c:{},rows:"textarea"===e.inputType?6:1,multiline:"textarea"===e.inputType},t):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"date"===e.inputType||"datetime"===e.inputType?(0,i.jsx)(j.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:w,description:"".concat(e.inputId,"-description"),error:null==_?void 0:null===(n=_.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],gridProps:null!==(h=e.gridProps)&&void 0!==h?h:{},time:"datetime"===e.inputType},t):null})]})]}),e.inputs?(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(u.Z,{onClick:L,variant:"outlined",children:"Cancel"}),(0,i.jsx)(u.Z,{onClick:I(P),variant:"outlined",children:null==e?void 0:e.submitButtonText})]}):null]})})}}},function(e){e.O(0,[891,842,536,215,292,763,981,774,888,179],function(){return e(e.s=97475)}),_N_E=e.O()}]);