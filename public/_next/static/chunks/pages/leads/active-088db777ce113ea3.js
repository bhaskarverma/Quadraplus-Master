(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{99403:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leads/active",function(){return n(44590)}])},15271:function(e,t,n){"use strict";n.d(t,{A4:function(){return l},Dm:function(){return a},Yd:function(){return u},_n:function(){return o}});let i=["January","February","March","April","May","June","July","August","September","October","November","December"],l=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},a=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},s=e=>new Date(e),r=e=>"0"!==e.charAt(0)&&1===e.length?"0"+e:e,o=e=>{let t=s(e),n=r(t.getDate().toString()),i=r((t.getMonth()+1).toString()),l=t.getFullYear().toString();return"".concat(l,"-").concat(i,"-").concat(n)},u=e=>{if(""==e)return"";let t=s(e),n=t.getFullYear()+"-"+r((t.getMonth()+1).toString())+"-"+r(t.getDate().toString())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return n}},44590:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var i=n(85893),l=n(80562),a=n(73812),s=n(31538),r=n(29630),o=n(79072),u=n(49837),d=n(62443),p=n(67294),c=n(10667),m=n(9473),x=n(99610),b=n(18424),v=n(23213),h=n(46160),f=n(3690),g=n(68045),C=n(15271),y=n(89829),j=n(96927),_=n(59232),I=n(29620),T=n(77745),Z=n(95398),S=n(76779),L=n(75084),P=n(61953),w=n(67074),O=n(17494),k=n(87413),N=n(72162),D=n(9601),E=n(51221),U=n(36599),A=n(39673),F=n(48621),B=n(40883),z=n(87536);let W=(0,w.ZP)(U.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}});var M=function(e){var t,n,l,a;let s=(()=>{let t={input:[]};return e.inputs&&e.inputs.forEach(e=>{let n={};n[e.inputId]="",t.input.push(n)}),t})(),{control:u,handleSubmit:d,reset:p,formState:{errors:c}}=(0,z.cI)({defaultValues:s}),m=()=>{e.setIsOpen(!1),p()},x=t=>{e.setIsOpen(!1),p(),e.onSubmit&&e.onSubmit(t)},b=t=>{var n;return e.inputs&&(null===(n=e.inputs.find(e=>e.inputId===t))||void 0===n?void 0:n.menuItems)};return(0,i.jsx)("div",{children:(0,i.jsxs)(I.Z,{maxWidth:e.maxWidth,fullWidth:!0,open:e.isOpen,onClose:m,children:[(0,i.jsx)(T.Z,{children:e.dialogTitle}),(0,i.jsxs)(Z.Z,{children:[(0,i.jsx)(o.ZP,{container:!0,spacing:5,children:(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(W,{children:e.timelineData.map((e,t)=>(0,i.jsxs)(k.Z,{children:[(0,i.jsxs)(D.Z,{children:[(0,i.jsx)(O.Z,{color:"success",variant:"outlined"}),(0,i.jsx)(E.Z,{})]}),(0,i.jsx)(N.Z,{children:(0,i.jsxs)(P.Z,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(r.Z,{variant:"body2",sx:{justifyContent:"flex-start",mr:2,fontWeight:600,color:"text.primary"},children:e.text}),(0,i.jsx)(r.Z,{sx:{justifyContent:"flex-end",flex:"0 0 11em"},variant:"caption",children:e.date})]})})]},t))})})}),(0,i.jsxs)(o.ZP,{container:!0,spacing:5,children:[e.inputs&&e.inputs.map((e,l)=>{var a,s;return"select"===e.inputType?(0,i.jsx)(A.Z,{name:"input.".concat(l,".").concat(e.inputId),label:e.inputLabel,labelId:e.inputLabelId,inputId:e.inputId,menuItems:null!==(t=b(e.inputId))&&void 0!==t?t:[],control:u,description:"".concat(e.inputId,"-description"),error:null==c?void 0:null===(a=c.input)||void 0===a?void 0:null===(s=a[l])||void 0===s?void 0:s[e.inputId],gridProps:null!==(n=e.gridProps)&&void 0!==n?n:{}},l):null}),e.inputs&&e.inputs.map((e,t)=>{var n,a;return"text"===e.inputType||"textarea"==e.inputType||"number"==e.inputType||"email"==e.inputType?(0,i.jsx)(F.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:u,description:"".concat(e.inputId,"-description"),error:null==c?void 0:null===(n=c.input)||void 0===n?void 0:null===(a=n[t])||void 0===a?void 0:a[e.inputId],type:e.inputType,gridProps:null!==(l=e.gridProps)&&void 0!==l?l:{},rows:"textarea"===e.inputType?6:1,multiline:"textarea"===e.inputType},t):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"date"===e.inputType||"datetime"===e.inputType?(0,i.jsx)(B.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:u,description:"".concat(e.inputId,"-description"),error:null==c?void 0:null===(n=c.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],gridProps:null!==(a=e.gridProps)&&void 0!==a?a:{},time:"datetime"===e.inputType},t):null})]})]}),e.inputs?(0,i.jsxs)(S.Z,{children:[(0,i.jsx)(L.Z,{onClick:m,variant:"outlined",children:"Cancel"}),(0,i.jsx)(L.Z,{onClick:d(x),variant:"outlined",children:null==e?void 0:e.submitButtonText})]}):null]})})},q=n(86501);let H={GREEN:"success",ORANGE:"warning",RED:"error"},R=e=>{let{id:t,course_id:n}=e,[r,o]=(0,p.useState)(null),u=(0,m.I0)(),d=(0,b.a)(),c=d.token,[v,I]=(0,p.useState)(!1),[T,Z]=(0,p.useState)(!1),[S,L]=(0,p.useState)(!1),[P,w]=(0,p.useState)(!1),[O,k]=(0,p.useState)([]),[N,D]=(0,p.useState)(!1),[E,U]=(0,p.useState)(""),[A,F]=(0,p.useState)(""),[B,z]=(0,p.useState)(),[W,q]=(0,p.useState)([]),[H,R]=(0,p.useState)(!1),[Q,G]=(0,p.useState)(!1),J=Boolean(r),X=()=>{G(!Q)},Y=e=>{let n=Object.values(e.input[0])[0];u((0,x.XH)({token:c,lead_id:t,type:n}))};(0,p.useEffect)(()=>{(async function(){let e=await (0,j.Z)(c).get("/leads/followup/details/".concat(t));z(e.data.lead)})()},[t,c,Q]),(0,p.useEffect)(()=>{if(B){let e=B.followups.map(e=>({text:e.remarks,date:(0,C.A4)(e.date_of_next_action)}));q(e)}},[B]),(0,p.useEffect)(()=>{(async function(){let e=await (0,j.Z)(c).post("/batch/list/available",{course_id:n});k(e.data.batches.map(e=>({label:"".concat(e.location," - ").concat(e.course_name," - ").concat(e.start_date),value:e.id.toString()})))})()},[n,c]);let K=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=(0,C._n)(i);u((0,x._m)({token:c,lead_id:t,remarks:n,follow_up_date:l})),X()},V=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];"Converted"===n?(D(!0),U(n),F(i)):u((0,x.U6)({token:c,lead_id:t,status:n,closing_remark:i}))},$=e=>{o(e.currentTarget)},ee=()=>{o(null)},et=()=>{ee(),R(!0)},en=e=>{let n=Object.values(e.input[0])[0];u((0,x.Dc)({token:c,lead_id:t,quoted_price:parseInt(n)}))},ei=()=>{u((0,x.ks)({token:c,lead_id:t}))},el=()=>{ee(),I(!0)},ea=()=>{ee(),Z(!0)},es=()=>{ee(),L(!0)},er=()=>{ee(),w(!0)},eo=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=Object.values(e.input[2])[0];u((0,_.O2)({token:c,batchGroup:{batch_id:parseInt(n),participant_id:t,payment_method:l,paid_amt:parseInt(i)}})),u((0,x.U6)({token:c,lead_id:t,status:E,closing_remark:A}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{size:"small",onClick:$,children:(0,i.jsx)(h.Z,{})}),(0,i.jsxs)(a.Z,{keepMounted:!0,anchorEl:r,open:J,onClose:ee,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(s.Z,{onClick:er,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Unassign Self"]}),(0,i.jsxs)(s.Z,{onClick:el,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Change Lead Probability"]}),(0,i.jsxs)(s.Z,{onClick:ea,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Follow Up"]}),(0,i.jsxs)(s.Z,{onClick:et,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Assign Quoted Price"]}),(0,i.jsxs)(s.Z,{onClick:es,children:[(0,i.jsx)(f.Z,{fontSize:"small",sx:{mr:2}}),"Close Lead"]})]}),(0,i.jsx)(g.Z,{dialogTitle:"Update Lead Probability",isOpen:v,setIsOpen:I,onSubmit:Y,submitButtonText:"Update",inputs:[{inputId:"type",inputLabel:"Probability",inputType:"select",inputLabelId:"type-label",gridProps:{md:6},menuItems:[{value:"high",label:"HIGH"},{value:"medium",label:"MEDIUM"},{value:"low",label:"LOW"}]}]}),(0,i.jsx)(g.Z,{dialogTitle:"Assign Quoted Price",isOpen:H,setIsOpen:R,submitButtonText:"Assign",onSubmit:en,inputs:[{inputId:"quoted_price",inputLabel:"Quoted Price",inputType:"number",inputLabelId:"quoted_price-label",gridProps:{md:6}}]}),(0,i.jsx)(g.Z,{dialogTitle:"Close Lead",isOpen:S,setIsOpen:L,onSubmit:V,submitButtonText:"Close Lead",maxWidth:"lg",inputs:[{inputId:"status",inputLabel:"Status",inputType:"select",inputLabelId:"status-select",gridProps:{md:3},menuItems:[{value:"Converted",label:"Converted"},{value:"Failed",label:"Failed"}]},{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}}]}),(0,i.jsx)(y.Z,{agreeText:"Unassign",dialogText:"Confirm Unassign Self From The Lead",dialogTitle:"Confirm Unassign Self",disagreeText:"Cancel",isOpen:P,setOnAgree:ei,setOpen:w}),(0,i.jsx)(g.Z,{isOpen:N,setIsOpen:D,dialogTitle:"Assign Participant",submitButtonText:"Assign",onSubmit:eo,maxWidth:"lg",inputs:[{inputId:"batches",inputType:"select",inputLabel:"Batches",inputLabelId:"batches-label",menuItems:O,gridProps:{mb:6,md:4}},{inputId:"payment_amount",inputType:"number",inputLabel:"Payment Amount",inputLabelId:"payment_amount-label",gridProps:{mb:6,md:4}},{inputId:"payment_type",inputType:"select",inputLabel:"Payment Type",inputLabelId:"payment_type-label",menuItems:[{value:"Cash",label:"Cash"},{value:"Online",label:"Online"},{value:"Credit Card",label:"Credit Card"},{value:"Bank Deposit",label:"Bank Deposit"},{value:"Bank Transfer",label:"Bank Transfer"}],gridProps:{mb:6,md:4}}]}),(0,i.jsx)(M,{dialogTitle:"Lead Followup History",isOpen:T,setIsOpen:Z,onSubmit:K,maxWidth:"md",timelineData:W,submitButtonText:"Add Followup",inputs:[{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}},{inputId:"followup_date",inputLabel:"Follow Up Date",inputType:"date",inputLabelId:"followup_date-label",gridProps:{md:3}}]})]})},Q=[{flex:.1,field:"name",headerName:"Name",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.name),q.ZP.success("Text Copied Successfully")},children:t.name})}},{flex:.1,field:"contact_no",headerName:"Contact No",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.contact_no),q.ZP.success("Text Copied Successfully")},children:t.contact_no})}},{flex:.1,field:"email",headerName:"Email",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.email),q.ZP.success("Text Copied Successfully")},children:t.email})}},{flex:.1,field:"company",headerName:"Company",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.company),q.ZP.success("Text Copied Successfully")},children:t.company})}},{flex:.1,field:"course_name",headerName:"Course",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.course_name),q.ZP.success("Text Copied Successfully")},children:t.course_name})}},{flex:.1,field:"quoted_price",headerName:"Quoted Price",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{variant:"body2",children:t.quoted_price})}},{flex:.1,field:"next_update",headerName:"Next Update",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{variant:"body2",children:"Nothing Found"!==t.next_update?(0,C.Dm)(t.next_update):t.next_update})}},{flex:.1,field:"type",headerName:"Probability",renderCell(e){let{row:t}=e;return(0,i.jsx)(v.Z,{skin:"light",size:"small",label:t.type.toUpperCase(),color:H[t.type.toUpperCase()],sx:{textTransform:"capitalize"}})}},{flex:.1,minWidth:90,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:t}=e;return(0,i.jsx)(R,{id:t.id,course_id:t.course_id})}}];var G=function(){let[e,t]=(0,p.useState)([]),[n,l]=(0,p.useState)(10),[a,s]=(0,p.useState)(""),r=(0,m.I0)(),v=(0,m.v9)(e=>e.leads),h=(0,b.a)(),f=h.token,g=e=>{s(e)};return(0,p.useEffect)(()=>{r((0,x.Ud)({token:f}))},[r,f]),(0,p.useEffect)(()=>{let e=v.activeLeads.filter(e=>{var t,n,i,l,s,r,o,u,d,p,c,m;return(null===(n=null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes(a.toLowerCase()))||(null===(l=null===(i=e.contact_no)||void 0===i?void 0:i.toLowerCase())||void 0===l?void 0:l.includes(a.toLowerCase()))||(null===(r=null===(s=e.email)||void 0===s?void 0:s.toLowerCase())||void 0===r?void 0:r.includes(a.toLowerCase()))||(null===(u=null===(o=e.company)||void 0===o?void 0:o.toLowerCase())||void 0===u?void 0:u.includes(a.toLowerCase()))||(null===(p=null===(d=e.course_name)||void 0===d?void 0:d.toLowerCase())||void 0===p?void 0:p.includes(a.toLowerCase()))||(null===(m=null===(c=e.type)||void 0===c?void 0:c.toLowerCase())||void 0===m?void 0:m.includes(a.toLowerCase()))});t(e)},[a,v.activeLeads]),(0,i.jsxs)(o.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(o.ZP,{item:!0,xs:12}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(c.Z,{exportFileName:"Active Leads",exportData:(()=>{let t=e.map(e=>({Name:e.name,"Contact No":e.contact_no,Email:e.email,Company:e.company,Course:e.course_name,"Quoted Price":e.quoted_price,Type:e.type.toUpperCase(),"Next Update":e.next_update}));return t})(),handleFilter:g,searchBoxText:"Search Leads",value:a}),(0,i.jsx)(d._,{autoHeight:!0,pagination:!0,rows:e,columns:Q,disableSelectionOnClick:!0,pageSize:Number(n),rowsPerPageOptions:[10,25,50],onPageSizeChange:e=>l(e)})]})})]})}}},function(e){e.O(0,[891,536,215,686,763,981,774,888,179],function(){return e(e.s=99403)}),_N_E=e.O()}]);