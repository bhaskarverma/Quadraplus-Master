(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{97475:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leads/followup-today",function(){return n(7072)}])},15271:function(e,t,n){"use strict";n.d(t,{A4:function(){return l},Dm:function(){return a},Yd:function(){return u},_n:function(){return r}});let i=["January","February","March","April","May","June","July","August","September","October","November","December"],l=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},a=e=>{let t=e.split("-"),n=t[2],l=i[parseInt(t[1])-1],a=t[0];return"".concat(n," ").concat(l," ").concat(a)},s=e=>new Date(e),o=e=>"0"!==e.charAt(0)&&1===e.length?"0"+e:e,r=e=>{let t=s(e),n=o(t.getDate().toString()),i=o((t.getMonth()+1).toString()),l=t.getFullYear().toString();return"".concat(l,"-").concat(i,"-").concat(n)},u=e=>{if(""==e)return"";let t=s(e),n=t.getFullYear()+"-"+o((t.getMonth()+1).toString())+"-"+o(t.getDate().toString())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return n}},7072:function(e,t,n){"use strict";n.r(t);var i=n(85893),l=n(80562),a=n(73812),s=n(31538),o=n(29630),r=n(79072),u=n(49837),d=n(62443),p=n(67294),c=n(10667),m=n(9473),x=n(99610),b=n(18424),f=n(23213),h=n(46160),v=n(3690),g=n(68045),y=n(15271),C=n(89829),j=n(86501),_=n(93023),I=n(96927),T=n(59232);let Z={GREEN:"success",ORANGE:"warning",RED:"error"},S=e=>{let{id:t,course_id:n}=e,[o,r]=(0,p.useState)(null),u=(0,m.I0)(),d=(0,b.a)(),c=d.token,[f,j]=(0,p.useState)(""),[Z,S]=(0,p.useState)(""),[w,L]=(0,p.useState)([]),[P,k]=(0,p.useState)(!1),[O,N]=(0,p.useState)(!1),[D,E]=(0,p.useState)(!1),[F,U]=(0,p.useState)(!1),[A,B]=(0,p.useState)(!1),[z,M]=(0,p.useState)([]),[W,H]=(0,p.useState)(),[R,G]=(0,p.useState)(!1),J=Boolean(o),X=e=>{let n=Object.values(e.input[0])[0];u((0,x.XH)({token:c,lead_id:t,type:n}))};(0,p.useEffect)(()=>{(async function(){let e=await (0,I.Z)(c).post("/batch/list/available",{course_id:n});L(e.data.batches.map(e=>({label:"".concat(e.location," - ").concat(e.course_name," - ").concat(e.start_date),value:e.id.toString()})))})()},[n,c]),(0,p.useEffect)(()=>{if(W){let e=W.followups.map(e=>({text:e.remarks,date:(0,y.A4)(e.date_of_next_action)}));M(e)}},[W]),(0,p.useEffect)(()=>{(async function(){let e=await (0,I.Z)(c).get("/leads/followup/details/".concat(t));H(e.data.lead)})()},[t,c,R]);let Y=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=(0,y._n)(i);u((0,x._m)({token:c,lead_id:t,remarks:n,follow_up_date:l}))},q=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];"Converted"===n?(k(!0),j(n),S(i)):u((0,x.U6)({token:c,lead_id:t,status:n,closing_remark:i}))},K=e=>{r(e.currentTarget)},Q=()=>{r(null)},V=()=>{u((0,x.ks)({token:c,lead_id:t}))},$=()=>{Q(),N(!0)},ee=()=>{Q(),E(!0)},et=()=>{Q(),U(!0)},en=e=>{let n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],l=Object.values(e.input[2])[0],a=n.length;if(1==a){let s=n[0];u((0,T.O2)({token:c,batchGroup:{batch_id:parseInt(s),participant_id:t,payment_method:l,paid_amt:parseInt(i)}}))}else u((0,T.Zy)({token:c,batchGroupMultiple:{batch_id:n,participant_id:t,payment_method:l,paid_amt:parseInt(i)}}))},ei=()=>{Q(),B(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{size:"small",onClick:K,children:(0,i.jsx)(h.Z,{})}),(0,i.jsxs)(a.Z,{keepMounted:!0,anchorEl:o,open:J,onClose:Q,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,i.jsxs)(s.Z,{onClick:ei,children:[(0,i.jsx)(v.Z,{fontSize:"small",sx:{mr:2}}),"Unassign Self"]}),(0,i.jsxs)(s.Z,{onClick:$,children:[(0,i.jsx)(v.Z,{fontSize:"small",sx:{mr:2}}),"Change Lead Probability"]}),(0,i.jsxs)(s.Z,{onClick:ee,children:[(0,i.jsx)(v.Z,{fontSize:"small",sx:{mr:2}}),"Follow Up"]}),(0,i.jsxs)(s.Z,{onClick:et,children:[(0,i.jsx)(v.Z,{fontSize:"small",sx:{mr:2}}),"Close"]})]}),(0,i.jsx)(g.Z,{dialogTitle:"Update Lead Probability",isOpen:O,setIsOpen:N,onSubmit:X,submitButtonText:"Update",inputs:[{inputId:"type",inputLabel:"Probability",inputType:"select",inputLabelId:"type-label",gridProps:{md:6},menuItems:[{value:"high",label:"HIGH"},{value:"medium",label:"MEDIUM"},{value:"low",label:"LOW"}]}]}),(0,i.jsx)(_.Z,{dialogTitle:"Lead Followup History",isOpen:D,setIsOpen:E,onSubmit:Y,maxWidth:"md",timelineData:z,submitButtonText:"Add Followup",inputs:[{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}},{inputId:"followup_date",inputLabel:"Follow Up Date",inputType:"date",inputLabelId:"followup_date-label",gridProps:{md:3}}]}),(0,i.jsx)(g.Z,{dialogTitle:"Close Lead",isOpen:F,setIsOpen:U,onSubmit:q,submitButtonText:"Close Lead",inputs:[{inputId:"status",inputLabel:"Status",inputType:"select",inputLabelId:"status-select",gridProps:{md:6},menuItems:[{value:"Converted",label:"Converted"},{value:"Failed",label:"Failed"}]},{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:6}}]}),(0,i.jsx)(g.Z,{isOpen:P,setIsOpen:k,dialogTitle:"Assign Participant",submitButtonText:"Assign",onSubmit:en,maxWidth:"lg",inputs:[{inputId:"batches",inputType:"select",selectMultiple:!0,inputLabel:"Batches",inputLabelId:"batches-label",menuItems:w,gridProps:{mb:6,md:4}},{inputId:"payment_amount",inputType:"number",inputLabel:"Payment Amount",inputLabelId:"payment_amount-label",gridProps:{mb:6,md:4}},{inputId:"payment_type",inputType:"select",inputLabel:"Payment Type",inputLabelId:"payment_type-label",menuItems:[{value:"Cash",label:"Cash"},{value:"Online",label:"Online"},{value:"Credit Card",label:"Credit Card"},{value:"Bank Deposit",label:"Bank Deposit"},{value:"Bank Transfer",label:"Bank Transfer"}],gridProps:{mb:6,md:4}}]}),(0,i.jsx)(C.Z,{agreeText:"Unassign",dialogText:"Confirm Unassign Self From The Lead",dialogTitle:"Confirm Unassign Self",disagreeText:"Cancel",isOpen:A,setOnAgree:V,setOpen:B})]})},w=[{flex:.1,field:"name",headerName:"Name",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.name),j.ZP.success("Text Copied Successfully")},children:t.name})}},{flex:.1,field:"contact_no",headerName:"Contact No",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.contact_no),j.ZP.success("Text Copied Successfully")},children:t.contact_no})}},{flex:.1,field:"email",headerName:"Email",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.email),j.ZP.success("Text Copied Successfully")},children:t.email})}},{flex:.1,field:"company",headerName:"Company",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.company),j.ZP.success("Text Copied Successfully")},children:t.company})}},{flex:.1,field:"course_name",headerName:"Course",renderCell(e){let{row:t}=e;return(0,i.jsx)("div",{onDoubleClick(){navigator.clipboard.writeText(t.course_name),j.ZP.success("Text Copied Successfully")},children:t.course_name})}},{flex:.1,field:"next_update",headerName:"Next Update",renderCell(e){let{row:t}=e;return(0,i.jsx)(o.Z,{variant:"body2",children:(0,y.Dm)(t.next_update)})}},{flex:.1,field:"type",headerName:"Probability",renderCell(e){let{row:t}=e;return(0,i.jsx)(f.Z,{skin:"light",size:"small",label:t.type.toUpperCase(),color:Z[t.type.toUpperCase()],sx:{textTransform:"capitalize"}})}},{flex:.1,minWidth:90,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:t}=e;return(0,i.jsx)(S,{id:t.id,course_id:t.course_id})}}];t.default=function(){let[e,t]=(0,p.useState)([]),[n,l]=(0,p.useState)(10),[a,s]=(0,p.useState)(""),o=(0,m.I0)(),f=(0,m.v9)(e=>e.leads),h=(0,b.a)(),v=h.token,g=e=>{s(e)};return(0,p.useEffect)(()=>{o((0,x.dN)({token:v}))},[o,v]),(0,p.useEffect)(()=>{if(f.followupLeads){let e=f.followupLeads.filter(e=>{var t,n,i,l,s;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(n=e.contact_no)||void 0===n?void 0:n.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(i=e.email)||void 0===i?void 0:i.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(l=e.company)||void 0===l?void 0:l.toLowerCase().includes(a.toLowerCase()))||(null==e?void 0:null===(s=e.course_name)||void 0===s?void 0:s.toLowerCase().includes(a.toLowerCase()))});t(e)}},[a,f.followupLeads]),(0,i.jsxs)(r.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(r.ZP,{item:!0,xs:12}),(0,i.jsx)(r.ZP,{item:!0,xs:12,children:(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(c.Z,{exportFileName:"Followup Leads for Today",exportData:(()=>{let t=e.map(e=>({Name:e.name,"Contact No":e.contact_no,Email:e.email,Company:e.company,Course:e.course_name,Type:e.type.toUpperCase()}));return t})(),handleFilter:g,searchBoxText:"Search Leads",value:a}),(0,i.jsx)(d._,{autoHeight:!0,pagination:!0,rows:e,columns:w,disableSelectionOnClick:!0,pageSize:Number(n),rowsPerPageOptions:[10,25,50],onPageSizeChange:e=>l(e)})]})})]})}},93023:function(e,t,n){"use strict";var i=n(85893),l=n(29620),a=n(77745),s=n(95398),o=n(79072),r=n(76779),u=n(75084),d=n(61953),p=n(67074),c=n(17494),m=n(87413),x=n(29630),b=n(72162),f=n(9601),h=n(51221),v=n(36599),g=n(39673),y=n(48621),C=n(40883),j=n(87536);let _=(0,p.ZP)(v.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}});t.Z=function(e){var t,n,p,v;let I=(()=>{let t={input:[]};return e.inputs&&e.inputs.forEach(e=>{let n={};n[e.inputId]="",t.input.push(n)}),t})(),{control:T,handleSubmit:Z,reset:S,formState:{errors:w}}=(0,j.cI)({defaultValues:I}),L=()=>{e.setIsOpen(!1),S()},P=t=>{e.setIsOpen(!1),S(),e.onSubmit&&e.onSubmit(t)},k=t=>{var n;return e.inputs&&(null===(n=e.inputs.find(e=>e.inputId===t))||void 0===n?void 0:n.menuItems)};return(0,i.jsx)("div",{children:(0,i.jsxs)(l.Z,{maxWidth:e.maxWidth,fullWidth:!0,open:e.isOpen,onClose:L,children:[(0,i.jsx)(a.Z,{children:e.dialogTitle}),(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(o.ZP,{container:!0,spacing:5,children:(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(_,{children:e.timelineData.map((e,t)=>(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(c.Z,{color:"success",variant:"outlined"}),(0,i.jsx)(h.Z,{})]}),(0,i.jsx)(b.Z,{children:(0,i.jsxs)(d.Z,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(x.Z,{variant:"body2",sx:{justifyContent:"flex-start",mr:2,fontWeight:600,color:"text.primary"},children:e.text}),(0,i.jsx)(x.Z,{sx:{justifyContent:"flex-end",flex:"0 0 11em"},variant:"caption",children:e.date})]})})]},t))})})}),(0,i.jsxs)(o.ZP,{container:!0,spacing:5,children:[e.inputs&&e.inputs.map((e,l)=>{var a,s;return"select"===e.inputType?(0,i.jsx)(g.Z,{name:"input.".concat(l,".").concat(e.inputId),label:e.inputLabel,labelId:e.inputLabelId,inputId:e.inputId,menuItems:null!==(t=k(e.inputId))&&void 0!==t?t:[],control:T,description:"".concat(e.inputId,"-description"),error:null==w?void 0:null===(a=w.input)||void 0===a?void 0:null===(s=a[l])||void 0===s?void 0:s[e.inputId],gridProps:null!==(n=e.gridProps)&&void 0!==n?n:{}},l):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"text"===e.inputType||"textarea"==e.inputType||"number"==e.inputType||"email"==e.inputType?(0,i.jsx)(y.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:T,description:"".concat(e.inputId,"-description"),error:null==w?void 0:null===(n=w.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],type:e.inputType,gridProps:null!==(p=e.gridProps)&&void 0!==p?p:{},rows:"textarea"===e.inputType?6:1,multiline:"textarea"===e.inputType},t):null}),e.inputs&&e.inputs.map((e,t)=>{var n,l;return"date"===e.inputType||"datetime"===e.inputType?(0,i.jsx)(C.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:T,description:"".concat(e.inputId,"-description"),error:null==w?void 0:null===(n=w.input)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l[e.inputId],gridProps:null!==(v=e.gridProps)&&void 0!==v?v:{},time:"datetime"===e.inputType},t):null})]})]}),e.inputs?(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(u.Z,{onClick:L,variant:"outlined",children:"Cancel"}),(0,i.jsx)(u.Z,{onClick:Z(P),variant:"outlined",children:null==e?void 0:e.submitButtonText})]}):null]})})}}},function(e){e.O(0,[891,842,536,215,292,763,981,774,888,179],function(){return e(e.s=97475)}),_N_E=e.O()}]);