(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{99403:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leads/active",function(){return n(44590)}])},15271:function(e,t,n){"use strict";n.d(t,{A4:function(){return a},Dm:function(){return r},Yd:function(){return s},_n:function(){return u}});var i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=function(e){var t=e.split("-"),n=t[2],a=i[parseInt(t[1])-1],r=t[0];return"".concat(n," ").concat(a," ").concat(r)},r=function(e){var t=e.split("-"),n=t[2],a=i[parseInt(t[1])-1],r=t[0];return"".concat(n," ").concat(a," ").concat(r)},o=function(e){return new Date(e)},l=function(e){return"0"!==e.charAt(0)&&1===e.length?"0"+e:e},u=function(e){var t=o(e),n=l(t.getDate().toString()),i=l((t.getMonth()+1).toString()),a=t.getFullYear().toString();return"".concat(a,"-").concat(i,"-").concat(n)},s=function(e){var t=o(e);return t.getFullYear()+"-"+l((t.getMonth()+1).toString())+"-"+l(t.getDate().toString())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},44590:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return K}});var i=n(34051),a=n.n(i),r=n(85893),o=n(93946),l=n(38333),u=n(18972),s=n(15861),c=n(86886),d=n(66242),p=n(24156),m=n(67294),f=n(10667),v=n(9473),x=n(99610),b=n(18424),h=n(23213),g=n(46160),y=n(3690),C=n(68045),j=n(15271),_=n(89829),Z=n(96927),T=n(59232),I=n(64666),w=n(37645),k=n(6514),S=n(31425),P=n(44872),L=n(87357),O=n(11496),N=n(17494),D=n(87413),E=n(72162),A=n(9601),U=n(51221),F=n(36599),B=n(39673),z=n(48621),W=n(40883),M=n(42283),q=(0,O.ZP)(F.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}});var H=function(e){var t,n,i,a,o=function(){var t={input:[]};return e.inputs&&e.inputs.forEach((function(e){var n={};n[e.inputId]="",t.input.push(n)})),t}(),l=(0,M.cI)({defaultValues:o}),u=l.control,d=l.handleSubmit,p=l.reset,m=l.formState.errors,f=function(){e.setIsOpen(!1),p()},v=function(t){var n;return e.inputs&&(null===(n=e.inputs.find((function(e){return e.inputId===t})))||void 0===n?void 0:n.menuItems)};return(0,r.jsx)("div",{children:(0,r.jsxs)(I.Z,{maxWidth:e.maxWidth,fullWidth:!0,open:e.isOpen,onClose:f,children:[(0,r.jsx)(w.Z,{children:e.dialogTitle}),(0,r.jsxs)(k.Z,{children:[(0,r.jsx)(c.ZP,{container:!0,spacing:5,children:(0,r.jsx)(c.ZP,{item:!0,xs:12,children:(0,r.jsx)(q,{children:e.timelineData.map((function(e,t){return(0,r.jsxs)(D.Z,{children:[(0,r.jsxs)(A.Z,{children:[(0,r.jsx)(N.Z,{color:"success",variant:"outlined"}),(0,r.jsx)(U.Z,{})]}),(0,r.jsx)(E.Z,{children:(0,r.jsxs)(L.Z,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(s.Z,{variant:"body2",sx:{justifyContent:"flex-start",mr:2,fontWeight:600,color:"text.primary"},children:e.text}),(0,r.jsx)(s.Z,{sx:{justifyContent:"flex-end",flex:"0 0 11em"},variant:"caption",children:e.date})]})})]},t)}))})})}),(0,r.jsxs)(c.ZP,{container:!0,spacing:5,children:[e.inputs&&e.inputs.map((function(e,i){var a,o;return"select"===e.inputType?(0,r.jsx)(B.Z,{name:"input.".concat(i,".").concat(e.inputId),label:e.inputLabel,labelId:e.inputLabelId,inputId:e.inputId,menuItems:null!==(t=v(e.inputId))&&void 0!==t?t:[],control:u,description:"".concat(e.inputId,"-description"),error:null===m||void 0===m||null===(a=m.input)||void 0===a||null===(o=a[i])||void 0===o?void 0:o[e.inputId],gridProps:null!==(n=e.gridProps)&&void 0!==n?n:{}},i):null})),e.inputs&&e.inputs.map((function(e,t){var n,a;return"text"===e.inputType||"textarea"==e.inputType||"number"==e.inputType||"email"==e.inputType?(0,r.jsx)(z.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:u,description:"".concat(e.inputId,"-description"),error:null===m||void 0===m||null===(n=m.input)||void 0===n||null===(a=n[t])||void 0===a?void 0:a[e.inputId],type:e.inputType,gridProps:null!==(i=e.gridProps)&&void 0!==i?i:{},rows:"textarea"===e.inputType?6:1,multiline:"textarea"===e.inputType},t):null})),e.inputs&&e.inputs.map((function(e,t){var n,i;return"date"===e.inputType||"datetime"===e.inputType?(0,r.jsx)(W.Z,{name:"input.".concat(t,".").concat(e.inputId),label:e.inputLabel,control:u,description:"".concat(e.inputId,"-description"),error:null===m||void 0===m||null===(n=m.input)||void 0===n||null===(i=n[t])||void 0===i?void 0:i[e.inputId],gridProps:null!==(a=e.gridProps)&&void 0!==a?a:{},time:"datetime"===e.inputType},t):null}))]})]}),e.inputs?(0,r.jsxs)(S.Z,{children:[(0,r.jsx)(P.Z,{onClick:f,variant:"outlined",children:"Cancel"}),(0,r.jsx)(P.Z,{onClick:d((function(t){e.setIsOpen(!1),p(),e.onSubmit&&e.onSubmit(t)})),variant:"outlined",children:null===e||void 0===e?void 0:e.submitButtonText})]}):null]})})},R=n(74931);function Q(e,t,n,i,a,r,o){try{var l=e[r](o),u=l.value}catch(s){return void n(s)}l.done?t(u):Promise.resolve(u).then(i,a)}function G(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var r=e.apply(t,n);function o(e){Q(r,i,a,o,l,"next",e)}function l(e){Q(r,i,a,o,l,"throw",e)}o(void 0)}))}}var J={GREEN:"success",ORANGE:"warning",RED:"error"},X=function(e){var t=e.id,n=e.course_id,i=(0,m.useState)(null),s=i[0],c=i[1],d=(0,v.I0)(),p=(0,b.a)().token,f=(0,m.useState)(!1),h=f[0],I=f[1],w=(0,m.useState)(!1),k=w[0],S=w[1],P=(0,m.useState)(!1),L=P[0],O=P[1],N=(0,m.useState)(!1),D=N[0],E=N[1],A=(0,m.useState)([]),U=A[0],F=A[1],B=(0,m.useState)(!1),z=B[0],W=B[1],M=(0,m.useState)(""),q=M[0],R=M[1],Q=(0,m.useState)(""),J=Q[0],X=Q[1],Y=(0,m.useState)(),K=Y[0],V=Y[1],$=(0,m.useState)([]),ee=$[0],te=$[1],ne=(0,m.useState)(!1),ie=ne[0],ae=ne[1],re=(0,m.useState)(!1),oe=re[0],le=re[1],ue=Boolean(s);(0,m.useEffect)((function(){function e(){return(e=G(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.Z)(p).get("/leads/followup/details/".concat(t));case 2:n=e.sent,V(n.data.lead);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,p,oe]),(0,m.useEffect)((function(){if(K){var e=K.followups.map((function(e){return{text:e.remarks,date:(0,j.A4)(e.date_of_next_action)}}));te(e)}}),[K]),(0,m.useEffect)((function(){function e(){return(e=G(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.Z)(p).post("/batch/list/available",{course_id:n});case 2:t=e.sent,F(t.data.batches.map((function(e){return{label:"".concat(e.location," - ").concat(e.course_name," - ").concat(e.start_date),value:e.id.toString()}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n,p]);var se=function(){c(null)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{size:"small",onClick:function(e){c(e.currentTarget)},children:(0,r.jsx)(g.Z,{})}),(0,r.jsxs)(l.Z,{keepMounted:!0,anchorEl:s,open:ue,onClose:se,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,r.jsxs)(u.Z,{onClick:function(){se(),E(!0)},children:[(0,r.jsx)(y.Z,{fontSize:"small",sx:{mr:2}}),"Unassign Self"]}),(0,r.jsxs)(u.Z,{onClick:function(){se(),I(!0)},children:[(0,r.jsx)(y.Z,{fontSize:"small",sx:{mr:2}}),"Change Lead Probability"]}),(0,r.jsxs)(u.Z,{onClick:function(){se(),S(!0)},children:[(0,r.jsx)(y.Z,{fontSize:"small",sx:{mr:2}}),"Follow Up"]}),(0,r.jsxs)(u.Z,{onClick:function(){se(),ae(!0)},children:[(0,r.jsx)(y.Z,{fontSize:"small",sx:{mr:2}}),"Assign Quoted Price"]}),(0,r.jsxs)(u.Z,{onClick:function(){se(),O(!0)},children:[(0,r.jsx)(y.Z,{fontSize:"small",sx:{mr:2}}),"Close Lead"]})]}),(0,r.jsx)(C.Z,{dialogTitle:"Update Lead Probability",isOpen:h,setIsOpen:I,onSubmit:function(e){var n=Object.values(e.input[0])[0];d((0,x.XH)({token:p,lead_id:t,type:n}))},submitButtonText:"Update",inputs:[{inputId:"type",inputLabel:"Probability",inputType:"select",inputLabelId:"type-label",gridProps:{md:6},menuItems:[{value:"high",label:"HIGH"},{value:"medium",label:"MEDIUM"},{value:"low",label:"LOW"}]}]}),(0,r.jsx)(C.Z,{dialogTitle:"Assign Quoted Price",isOpen:ie,setIsOpen:ae,submitButtonText:"Assign",onSubmit:function(e){var n=Object.values(e.input[0])[0];d((0,x.Dc)({token:p,lead_id:t,quoted_price:parseInt(n)}))},inputs:[{inputId:"quoted_price",inputLabel:"Quoted Price",inputType:"number",inputLabelId:"quoted_price-label",gridProps:{md:6}}]}),(0,r.jsx)(C.Z,{dialogTitle:"Close Lead",isOpen:L,setIsOpen:O,onSubmit:function(e){var n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];"Converted"===n?(W(!0),R(n),X(i)):d((0,x.U6)({token:p,lead_id:t,status:n,closing_remark:i}))},submitButtonText:"Close Lead",maxWidth:"lg",inputs:[{inputId:"status",inputLabel:"Status",inputType:"select",inputLabelId:"status-select",gridProps:{md:3},menuItems:[{value:"Converted",label:"Converted"},{value:"Failed",label:"Failed"}]},{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}}]}),(0,r.jsx)(_.Z,{agreeText:"Unassign",dialogText:"Confirm Unassign Self From The Lead",dialogTitle:"Confirm Unassign Self",disagreeText:"Cancel",isOpen:D,setOnAgree:function(){d((0,x.ks)({token:p,lead_id:t}))},setOpen:E}),(0,r.jsx)(C.Z,{isOpen:z,setIsOpen:W,dialogTitle:"Assign Participant",submitButtonText:"Assign",onSubmit:function(e){var n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],a=Object.values(e.input[2])[0];d((0,T.O2)({token:p,batchGroup:{batch_id:parseInt(n),participant_id:t,payment_method:a,paid_amt:parseInt(i)}})),d((0,x.U6)({token:p,lead_id:t,status:q,closing_remark:J}))},maxWidth:"lg",inputs:[{inputId:"batches",inputType:"select",inputLabel:"Batches",inputLabelId:"batches-label",menuItems:U,gridProps:{mb:6,md:4}},{inputId:"payment_amount",inputType:"number",inputLabel:"Payment Amount",inputLabelId:"payment_amount-label",gridProps:{mb:6,md:4}},{inputId:"payment_type",inputType:"select",inputLabel:"Payment Type",inputLabelId:"payment_type-label",menuItems:[{value:"Cash",label:"Cash"},{value:"Online",label:"Online"},{value:"Credit Card",label:"Credit Card"},{value:"Bank Deposit",label:"Bank Deposit"},{value:"Bank Transfer",label:"Bank Transfer"}],gridProps:{mb:6,md:4}}]}),(0,r.jsx)(H,{dialogTitle:"Lead Followup History",isOpen:k,setIsOpen:S,onSubmit:function(e){var n=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0],a=(0,j._n)(i);d((0,x._m)({token:p,lead_id:t,remarks:n,follow_up_date:a})),le(!oe)},maxWidth:"md",timelineData:ee,submitButtonText:"Add Followup",inputs:[{inputId:"remarks",inputLabel:"Remarks",inputType:"textarea",inputLabelId:"remarks-label",gridProps:{md:9}},{inputId:"followup_date",inputLabel:"Follow Up Date",inputType:"date",inputLabelId:"followup_date-label",gridProps:{md:3}}]})]})},Y=[{flex:.1,field:"name",headerName:"Name",renderCell:function(e){var t=e.row;return(0,r.jsx)("div",{onDoubleClick:function(){navigator.clipboard.writeText(t.name),R.ZP.success("Text Copied Successfully")},children:t.name})}},{flex:.1,field:"contact_no",headerName:"Contact No",renderCell:function(e){var t=e.row;return(0,r.jsx)("div",{onDoubleClick:function(){navigator.clipboard.writeText(t.contact_no),R.ZP.success("Text Copied Successfully")},children:t.contact_no})}},{flex:.1,field:"email",headerName:"Email",renderCell:function(e){var t=e.row;return(0,r.jsx)("div",{onDoubleClick:function(){navigator.clipboard.writeText(t.email),R.ZP.success("Text Copied Successfully")},children:t.email})}},{flex:.1,field:"company",headerName:"Company",renderCell:function(e){var t=e.row;return(0,r.jsx)("div",{onDoubleClick:function(){navigator.clipboard.writeText(t.company),R.ZP.success("Text Copied Successfully")},children:t.company})}},{flex:.1,field:"course_name",headerName:"Course",renderCell:function(e){var t=e.row;return(0,r.jsx)("div",{onDoubleClick:function(){navigator.clipboard.writeText(t.course_name),R.ZP.success("Text Copied Successfully")},children:t.course_name})}},{flex:.1,field:"quoted_price",headerName:"Quoted Price",renderCell:function(e){var t=e.row;return(0,r.jsx)(s.Z,{variant:"body2",children:t.quoted_price})}},{flex:.1,field:"next_update",headerName:"Next Update",renderCell:function(e){var t=e.row;return(0,r.jsx)(s.Z,{variant:"body2",children:"Nothing Found"!==t.next_update?(0,j.Dm)(t.next_update):t.next_update})}},{flex:.1,field:"type",headerName:"Probability",renderCell:function(e){var t=e.row;return(0,r.jsx)(h.Z,{skin:"light",size:"small",label:t.type.toUpperCase(),color:J[t.type.toUpperCase()],sx:{textTransform:"capitalize"}})}},{flex:.1,minWidth:90,sortable:!1,field:"actions",headerName:"Actions",renderCell:function(e){var t=e.row;return(0,r.jsx)(X,{id:t.id,course_id:t.course_id})}}];var K=function(){var e=(0,m.useState)([]),t=e[0],n=e[1],i=(0,m.useState)(10),a=i[0],o=i[1],l=(0,m.useState)(""),u=l[0],s=l[1],h=(0,v.I0)(),g=(0,v.v9)((function(e){return e.leads})),y=(0,b.a)().token;return(0,m.useEffect)((function(){h((0,x.Ud)({token:y}))}),[h,y]),(0,m.useEffect)((function(){var e=g.activeLeads.filter((function(e){var t,n,i,a,r,o,l,s,c,d,p,m;return(null===(n=null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes(u.toLowerCase()))||(null===(a=null===(i=e.contact_no)||void 0===i?void 0:i.toLowerCase())||void 0===a?void 0:a.includes(u.toLowerCase()))||(null===(o=null===(r=e.email)||void 0===r?void 0:r.toLowerCase())||void 0===o?void 0:o.includes(u.toLowerCase()))||(null===(s=null===(l=e.company)||void 0===l?void 0:l.toLowerCase())||void 0===s?void 0:s.includes(u.toLowerCase()))||(null===(d=null===(c=e.course_name)||void 0===c?void 0:c.toLowerCase())||void 0===d?void 0:d.includes(u.toLowerCase()))||(null===(m=null===(p=e.type)||void 0===p?void 0:p.toLowerCase())||void 0===m?void 0:m.includes(u.toLowerCase()))}));n(e)}),[u,g.activeLeads]),(0,r.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,r.jsx)(c.ZP,{item:!0,xs:12}),(0,r.jsx)(c.ZP,{item:!0,xs:12,children:(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(f.Z,{exportFileName:"Active Leads",exportData:t.map((function(e){return{Name:e.name,"Contact No":e.contact_no,Email:e.email,Company:e.company,Course:e.course_name,"Quoted Price":e.quoted_price,Type:e.type.toUpperCase(),"Next Update":e.next_update}})),handleFilter:function(e){s(e)},searchBoxText:"Search Leads",value:u}),(0,r.jsx)(p._,{autoHeight:!0,pagination:!0,rows:t,columns:Y,disableSelectionOnClick:!0,pageSize:Number(a),rowsPerPageOptions:[10,25,50],onPageSizeChange:function(e){return o(e)}})]})})]})}},89829:function(e,t,n){"use strict";var i=n(85893),a=n(67294),r=n(44872),o=n(64666),l=n(37645),u=n(6514),s=n(31425),c=n(58951);t.Z=function(e){var t=e.dialogTitle,n=e.dialogText,d=e.disagreeText,p=e.agreeText,m=e.isOpen,f=e.setOpen,v=e.setOnAgree,x=function(){return f(!1)};return(0,i.jsx)(a.Fragment,{children:(0,i.jsxs)(o.Z,{open:m,disableEscapeKeyDown:!0,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",onClose:function(e,t){"backdropClick"!==t&&x()},children:[(0,i.jsx)(l.Z,{id:"alert-dialog-title",children:t}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(c.Z,{id:"alert-dialog-description",children:n})}),(0,i.jsxs)(s.Z,{className:"dialog-actions-dense",children:[(0,i.jsx)(r.Z,{onClick:x,children:d}),(0,i.jsx)(r.Z,{onClick:v,children:p})]})]})})}}},function(e){e.O(0,[806,912,283,285,915,275,695,774,888,179],(function(){return t=99403,e(e.s=t);var t}));var t=e.O();_N_E=t}]);