(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{37645:function(e,t,n){"use strict";var a=n(87462),r=n(63366),i=n(67294),o=n(86010),s=n(27192),u=n(15861),l=n(11496),c=n(71657),d=n(4472),p=n(34182),m=n(85893);const f=["className","id"],h=(0,l.ZP)(u.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),x=i.forwardRef((function(e,t){const n=(0,c.Z)({props:e,name:"MuiDialogTitle"}),{className:u,id:l}=n,x=(0,r.Z)(n,f),b=n,v=(e=>{const{classes:t}=e;return(0,s.Z)({root:["root"]},d.a,t)})(b),{titleId:y=l}=i.useContext(p.Z);return(0,m.jsx)(h,(0,a.Z)({component:"h2",className:(0,o.Z)(v.root,u),ownerState:b,ref:t,variant:"h6",id:y},x))}));t.Z=x},59920:function(e,t,n){"use strict";var a;t.Z=void 0;var r=(0,((a=n(65129))&&a.__esModule?a:{default:a}).default)("M5,6H23V18H5V6M14,9A3,3 0 0,1 17,12A3,3 0 0,1 14,15A3,3 0 0,1 11,12A3,3 0 0,1 14,9M9,8A2,2 0 0,1 7,10V14A2,2 0 0,1 9,16H19A2,2 0 0,1 21,14V10A2,2 0 0,1 19,8H9M1,10H3V20H19V22H1V10Z","CashMultiple");t.Z=r},4620:function(e,t,n){"use strict";var a;t.Z=void 0;var r=(0,((a=n(65129))&&a.__esModule?a:{default:a}).default)("M2 12C2 16.97 6.03 21 11 21C13.39 21 15.68 20.06 17.4 18.4L15.9 16.9C14.63 18.25 12.86 19 11 19C4.76 19 1.64 11.46 6.05 7.05C10.46 2.64 18 5.77 18 12H15L19 16H19.1L23 12H20C20 7.03 15.97 3 11 3C6.03 3 2 7.03 2 12Z","Reload");t.Z=r},61384:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/batches/list/[id]",function(){return n(77665)}])},77665:function(e,t,n){"use strict";n.r(t);var a=n(34051),r=n.n(a),i=n(85893),o=n(16628),s=n(15861),u=n(87357),l=n(93946),c=n(34386),d=n(64666),p=n(6514),m=n(86886),f=n(66242),h=n(24156),x=n(67294),b=n(10667),v=n(18424),y=(n(95828),n(11163)),_=n(96927),Z=n(68045),j=n(59232),w=n(9473),g=n(17785),C=n(4620),P=n(59920),S=n(42734);function A(e,t,n,a,r,i,o){try{var s=e[i](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(a,r)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function o(e){A(i,a,r,o,s,"next",e)}function s(e){A(i,a,r,o,s,"throw",e)}o(void 0)}))}}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=(0,x.forwardRef)((function(e,t){return(0,i.jsx)(o.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){O(e,t,n[t])}))}return e}({ref:t},e))})),I=[{field:"payment_method",headerName:"Payment Method",flex:1,renderCell:function(e){var t=e.row;return(0,i.jsx)(s.Z,{variant:"body2",children:t.payment_mode})}},{field:"amount",headerName:"Amount",flex:1,renderCell:function(e){var t=e.row;return(0,i.jsxs)(s.Z,{variant:"body2",children:["AED ",t.amount]})}}],T=function(e){var t=e.row,n=(0,w.I0)(),a=(0,v.a)().token,o=(0,y.useRouter)().query.id,m=(0,x.useState)([]),f=m[0],b=m[1],A=(0,x.useState)(5),O=A[0],T=A[1],B=(0,x.useState)(!1),D=B[0],E=B[1],H=(0,x.useState)(!1),L=H[0],M=H[1],R=(0,x.useState)(!1),z=R[0],V=R[1];(0,x.useEffect)((function(){function e(){return(e=k(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.Z)(a).post("/batch/list/available",{batch_id:o,course_id:t.course_id});case 2:(n=e.sent).data.batches&&b(n.data.batches.map((function(e){return{label:"".concat(e.location," - ").concat(e.course_name," - ").concat(e.start_date),value:e.id.toString()}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[o,a,t.course_id]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(l.Z,{size:"small",onClick:function(){E(!0)},disabled:t.paid_amt==t.total_amt,children:(0,i.jsx)(c.Z,{title:"Add Payment",children:(0,i.jsx)(g.Z,{fontSize:"small"})})}),(0,i.jsx)(l.Z,{size:"small",onClick:function(){M(!0)},children:(0,i.jsx)(c.Z,{title:"Reassign Batch",children:(0,i.jsx)(C.Z,{fontSize:"small"})})}),(0,i.jsx)(l.Z,{size:"small",onClick:function(){V(!0)},children:(0,i.jsx)(c.Z,{title:"Payment Details",children:(0,i.jsx)(P.Z,{fontSize:"small"})})})]}),(0,i.jsx)(Z.Z,{dialogTitle:"Reassign Batch",isOpen:L,setIsOpen:M,submitButtonText:"Reassign",onSubmit:function(e){var r=Object.values(e.input[0])[0];n((0,j.y)({batch_group_id:t.id,batch_id:parseInt(r),token:a})),t.reRender()},maxWidth:"md",inputs:[{inputLabel:"New Batch",inputLabelId:"new-batch-label",inputId:"new-batch-input",inputType:"select",menuItems:f,gridProps:{md:6,mb:6}}]}),(0,i.jsx)(Z.Z,{dialogTitle:"Add Payment",isOpen:D,setIsOpen:E,submitButtonText:"Add",onSubmit:function(e){var r=Object.values(e.input[0])[0],i=Object.values(e.input[1])[0];n((0,j._w)({token:a,batch_group_id:t.id,payment:parseInt(r),payment_method:i})),t.reRender()},maxWidth:"md",inputs:[{inputId:"payment-amount",inputType:"number",inputLabel:"Payment Amount",inputLabelId:"payment-amount-label",gridProps:{mb:6,md:4}},{inputId:"payment-method",inputType:"select",inputLabel:"Payment Method",inputLabelId:"payment-method-label",menuItems:[{value:"Cash",label:"Cash"},{value:"Online",label:"Online"},{value:"Credit Card",label:"Credit Card"},{value:"Bank Deposit",label:"Bank Deposit"},{value:"Bank Transfer",label:"Bank Transfer"}],gridProps:{mb:6,md:4}}]}),(0,i.jsx)(d.Z,{fullWidth:!0,open:z,maxWidth:"lg",scroll:"body",onClose:function(){return V(!1)},TransitionComponent:N,onBackdropClick:function(){return V(!1)},children:(0,i.jsxs)(p.Z,{sx:{px:{xs:8,sm:15},py:{xs:8,sm:12.5},position:"relative"},children:[(0,i.jsx)(l.Z,{size:"small",onClick:function(){return V(!1)},sx:{position:"absolute",right:"1rem",top:"1rem"},children:(0,i.jsx)(S.Z,{})}),(0,i.jsx)(u.Z,{sx:{mb:4,textAlign:"center"},children:(0,i.jsx)(s.Z,{variant:"h5",sx:{mb:3},children:"Detailed Payment History"})}),(0,i.jsx)(h._,{autoHeight:!0,pagination:!0,rows:t.paymentDetails,columns:I,disableSelectionOnClick:!0,pageSize:Number(O),rowsPerPageOptions:[10,25,50],onPageSizeChange:function(e){return T(e)}})]})})]})},B=[{flex:.1,field:"participant",headerName:"Participant",renderCell:function(e){var t=e.row;return(0,i.jsx)(s.Z,{variant:"body2",children:t.participant})}},{flex:.1,field:"paid_amt",headerName:"Paid Amount",renderCell:function(e){var t=e.row;return(0,i.jsxs)(s.Z,{variant:"body2",children:["AED ",t.paid_amt]})}},{flex:.1,field:"total_amt",headerName:"Total Amount",renderCell:function(e){var t=e.row;return(0,i.jsxs)(s.Z,{variant:"body2",children:["AED ",t.total_amt]})}},{flex:.1,field:"balance_amt",headerName:"Balance Amount",renderCell:function(e){var t=e.row;return(0,i.jsxs)(s.Z,{variant:"body2",children:["AED ",t.total_amt-t.paid_amt]})}},{flex:.1,field:"payment_status",headerName:"Payment Status",renderCell:function(e){var t=e.row;return(0,i.jsx)(s.Z,{variant:"body2",children:t.payment_status})}},{flex:.1,field:"actions",headerName:"Actions",renderCell:function(e){var t=e.row;return(0,i.jsx)(T,{row:t})}}];t.default=function(){var e=(0,x.useState)([]),t=e[0],n=e[1],a=(0,x.useState)([]),o=a[0],s=a[1],u=(0,x.useState)(10),l=u[0],c=u[1],d=(0,x.useState)(""),p=d[0],Z=d[1],j=(0,x.useState)(0),w=j[0],g=j[1],C=(0,y.useRouter)(),P=C.query.id,S=(0,x.useState)(!1),A=S[0],O=S[1],N=(0,v.a)().token;(0,x.useEffect)((function(){var e=t.filter((function(e){return e.participant.toLowerCase().includes(p.toLowerCase())||e.payment_status.toLowerCase().includes(p.toLowerCase())||e.paid_amt.toString().includes(p)||e.total_amt.toString().includes(p)}));s(e)}),[t,p]),(0,x.useEffect)((function(){if(P){function e(){return t.apply(this,arguments)}function t(){return(t=k(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.Z)(N).get("/course/IDByBatch/".concat(P));case 2:t=e.sent,g(t.data.courseId);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e()}}),[P,N]);var I=C.query.id;return(0,x.useEffect)((function(){function e(){return(e=k(r().mark((function e(){var t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.Z)(N).post("/batch/list/group",{batch_id:I});case 2:t=e.sent,a=t.data.groups.map((function(e){return e.reRender=function(){O(!A)},e.course_id=w,e})),n(a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[I,N,A,w]),(0,i.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(m.ZP,{item:!0,xs:12}),(0,i.jsx)(m.ZP,{item:!0,xs:12,children:(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(b.Z,{exportFileName:"All Participants",exportData:t.map((function(e){return{Participant:e.participant,"Paid Amount":e.paid_amt,"Total Amount":e.total_amt,"Payment Method":e.payment_method,"Payment Status":e.payment_status}})),handleFilter:function(e){Z(e)},searchBoxText:"Search Participants",value:p}),(0,i.jsx)(h._,{autoHeight:!0,pagination:!0,rows:o,columns:B,disableSelectionOnClick:!0,pageSize:Number(l),rowsPerPageOptions:[10,25,50],onPageSizeChange:function(e){return c(e)}})]})})]})}},95828:function(){}},function(e){e.O(0,[806,912,661,283,285,915,695,774,888,179],(function(){return t=61384,e(e.s=t);var t}));var t=e.O();_N_E=t}]);